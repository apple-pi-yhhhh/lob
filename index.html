<head>
	<title>LOB - HOME</title>
	<link rel="stylesheet" href="/css/destyle.css">
	<link rel="stylesheet" href="/css/index.css">
	<script type="text/javascript" src="main.js"></script>
	<script type="text/javascript" src="books.js"></script>
	<!--
	<script
		src="https://code.jquery.com/jquery-3.4.1.min.js"
		integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
		crossorigin="anonymous">
	</script>
	<script>
		/*
		$(function() {
		alert("jQueryが正常に動作しています！");
		});
		*/
		// フォームID [isbn] に入力があった場合、jQueryの関数 [change] を使ってISBNコードを取得。
		// Google Books APIへ問い合わせを行う。
		// もしGoogle Books APIに書籍が存在しない(totalItemsが0の場合)、入力欄に表示されたデータをすべて消去し、該当書籍がないとメッセージを表示する

		$("#isbn").change(function() {
			const isbn = $("#isbn").val();
			const url = "https://www.googleapis.com/books/v1/volumes?q=isbn:" + isbn;

			$.getJSON(url, function(data) {
				if(!data.totalItems) {
					$("#isbn").val("");
					$("#BookTitle").text("");
					$("#BookAuthor").text("");
					$("#isbn10").text("");
					$("#isbn13").text("");
					$("#PublishedDate").text("");
					$("#BookThumbnail").text("");
					$("#BookDescription").text("");
					$("#BookMemo").val("");

					$("#message").html('<p class="bg-warning" id="warning">該当する書籍がありません。</p>');
					$('#message > p').fadeOut(3000);
				} else {

					// 該当書籍が存在した場合、JSONから値を取得して入力項目のデータを取得する

					$("#BookTitle").text(data.items[0].volumeInfo.title);
					$("#isbn13").text(data.items[0].volumeInfo.industryIdentifiers[0].identifier);
					$("#isbn10").text(data.items[0].volumeInfo.industryIdentifiers[1].identifier);
					$("#BookAuthor").text(data.items[0].volumeInfo.authors[0]);
					$("#PublishedDate").text(data.items[0].volumeInfo.publishedDate);
					$("#BookDescription").text(data.items[0].volumeInfo.description);
					$("#BookThumbnail").html('<img src=\"' + data.items[0].volumeInfo.imageLinks.smallThumbnail + '\" />');

        			}
      			});
  		});
	</script>
	-->
</head>
<body>
	<!--
	<form name="form1" id="id_form1" action="">
		<input name="textBox1" id="id_textBox1" type="text" value="" />
		<input type="button" value="Exec" onclick="onButtonClick();" />
	</form>
	<hr/>
	<div id="output"></div>
	-->
	
	<form id="isbn">
		<input type="text" id="isbn">
	</form>
	<div id="BookTitle"></div>
	<h1>結果だお！</h1>
</body>
